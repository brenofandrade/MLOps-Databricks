bundle:
  name: e2e-data-project

include:
  - resources/*.yml

targets:
  dev:
    mode: development
    default: true
    workspace:
      # IMPORTANT: use the full Databricks workspace URL (e.g. https://adb-<id>.<region>.databricks.com)
      host: https://testes.mlops
    variables:
      catalog_name: testes
      schema_name: mlops
      environment: dev

    # Override permissions for dev environment
    resources:
      jobs:
        data_ingestion_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
            - level: CAN_MANAGE_RUN
              group_name: Developers
        model_training_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
            - level: CAN_MANAGE_RUN
              group_name: Developers
        model_deployment_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
            - level: CAN_MANAGE_RUN
              group_name: Developers
        batch_inference_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
            - level: CAN_MANAGE_RUN
              group_name: Developers

  prod:
    mode: production
    workspace:
      # IMPORTANT: use the full Databricks workspace URL (e.g. https://adb-<id>.<region>.databricks.com)
      host: https://testes.mlops
    variables:
      catalog_name: testes
      schema_name: mlops
      environment: prod

    # Override permissions for prod environment (only PowerUsers group)
    resources:
      jobs:
        data_ingestion_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
        model_training_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
        model_deployment_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers
        batch_inference_job:
          permissions:
            - level: CAN_MANAGE
              group_name: PowerUsers

variables:
  catalog_name:
    description: Name of the Unity Catalog to use
    default: testes
  schema_name:
    description: Name of the Unity Catalog schema to use
    default: mlops
  environment:
    description: Environment name (dev/prod)
    default: dev
